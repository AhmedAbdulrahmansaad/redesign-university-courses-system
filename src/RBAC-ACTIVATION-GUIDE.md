# ๐ **ุฏููู ุชูุนูู ูุธุงู ูุตู ุงูุตูุงุญูุงุช - RBAC Activation Guide**

## ๐ **ูุนูููุงุช ุงููุธุงู:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงููุธุงู:            Role-Based Access Control (RBAC)
ุงููุณุชููุงุช:         3 ุฃุฏูุงุฑ
ุงูุญุงูุฉ:            โ ูุดุท ููุนูู
ุงูุชุงุฑูุฎ:           12 ููููุจุฑ 2025
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฅ **ุงูุฃุฏูุงุฑ ุงููุชุงุญุฉ (Roles):**

### **1๏ธโฃ ุทุงูุจ (Student)** - ุงูุฏูุฑ ุงูุงูุชุฑุงุถู
```
role: "student"

ุงูุตูุงุญูุงุช:
โ ุนุฑุถ ุงูููุฑุฑุงุช
โ ุงูุชุณุฌูู ูู ุงูููุฑุฑุงุช
โ ุนุฑุถ ุงูุฌุฏูู ุงูุฏุฑุงุณู
โ ุนุฑุถ ุงูุณุฌู ุงูุฃูุงุฏููู
โ ุนุฑุถ ุงููุณุชูุฏุงุช
โ ุงุณุชุฎุฏุงู ุงููุณุงุนุฏ ุงูุฐูู
โ ุงููุตูู ููุตูุญุงุช ุงูุนุงูุฉ

โ ูุง ููููู:
โ ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู
โ ุงูููุงููุฉ ุนูู ุทูุจุงุช ุงูุชุณุฌูู
โ ุฅุฏุงุฑุฉ ุงููุธุงู
```

### **2๏ธโฃ ูุดุฑู ุฃูุงุฏููู (Supervisor)**
```
role: "supervisor"

ุงูุตูุงุญูุงุช:
โ ูู ุตูุงุญูุงุช ุงูุทุงูุจ +
โ ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู
โ ุนุฑุถ ุทูุจุงุช ุงูุชุณุฌูู
โ ุงูููุงููุฉ/ุงูุฑูุถ ุนูู ุงูุทูุจุงุช
โ ุนุฑุถ ุจูุงูุงุช ุงูุทูุงุจ
โ ุชุตุฏูุฑ ุงูุชูุงุฑูุฑ

โ ูุง ููููู:
โ ุฅุฏุงุฑุฉ ุงููุธุงู ุงููุงููุฉ
โ ุญุฐู ุญุณุงุจุงุช
```

### **3๏ธโฃ ูุฏูุฑ (Admin)**
```
role: "admin"

ุงูุตูุงุญูุงุช:
โ ูู ุงูุตูุงุญูุงุช
โ ุฅุฏุงุฑุฉ ูุงููุฉ ูููุธุงู
โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
โ ุฅุฏุงุฑุฉ ุงูููุฑุฑุงุช
โ ุงููุตูู ูุฌููุน ุงูุตูุญุงุช
โ ุนุฑุถ ุฌููุน ุงูุฅุญุตุงุฆูุงุช
```

---

## ๐ **ุญุณุงุจุงุช ุฌุงูุฒุฉ ููุงุฎุชุจุงุฑ:**

### **ุญุณุงุจ ุทุงูุจ (Student Account):**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุจุฑูุฏ:          student@kku.edu.sa
ูููุฉ ุงููุฑูุฑ:     Student@123
ุงูุฑูู ุงูุฌุงูุนู:   442012345
ุงูุฏูุฑ:           student
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ูุงุฐุง ููููู:
โ ุงูุฏุฎูู ูุตูุญุฉ ุงูููุฑุฑุงุช
โ ุงูุชุณุฌูู ูู ุงูููุฑุฑุงุช
โ ุนุฑุถ ุงูุฌุฏูู
โ ุนุฑุถ ุงูุณุฌู ุงูุฃูุงุฏููู

ูุงุฐุง ูุง ููููู:
โ ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู
   โ ุณูุธูุฑ: "Access Denied"
   โ ุณููุญูููู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
```

### **ุญุณุงุจ ูุดุฑู (Supervisor Account):**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุจุฑูุฏ:          supervisor@kku.edu.sa
ูููุฉ ุงููุฑูุฑ:     Supervisor@123
ุงูุฑูู ุงูุฌุงูุนู:   442999001
ุงูุฏูุฑ:           supervisor
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ูุงุฐุง ููููู:
โ ูู ูุง ูููู ููุทุงูุจ
โ ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู
โ ุงูููุงููุฉ ุนูู ุทูุจุงุช ุงูุชุณุฌูู
โ ุนุฑุถ ุจูุงูุงุช ุงูุทูุงุจ
```

### **ุญุณุงุจ ูุฏูุฑ (Admin Account):**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุจุฑูุฏ:          admin@kku.edu.sa
ูููุฉ ุงููุฑูุฑ:     Admin@123
ุงูุฑูู ุงูุฌุงูุนู:   442999999
ุงูุฏูุฑ:           admin
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ูุงุฐุง ููููู:
โ ูู ุงูุตูุงุญูุงุช ุจุฏูู ุงุณุชุซูุงุก
โ ุฅุฏุงุฑุฉ ูุงููุฉ ูููุธุงู
```

---

## ๐ **ูุตูููุฉ ุงูุตูุงุญูุงุช (Access Matrix):**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุตูุญุฉ/ุงููุธููุฉ              ุทุงูุจ    ูุดุฑู    ูุฏูุฑ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ              โ      โ      โ
ุตูุญุฉ ุงูุชุนูุฏ                  โ      โ      โ
ุตูุญุฉ ุงูุชุณุฌูู                 โ      โ      โ
ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู            โ      โ      โ
ุนู ุงููุดุฑูุน                   โ      โ      โ
ูุฑุงุญู ุงููุดุฑูุน                โ      โ      โ
ุงูุฃุฎุจุงุฑ                      โ      โ      โ
ุงุชุตู ุจูุง                     โ      โ      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูููุฑุฑุงุช                     โ      โ      โ
ุงูุฌุฏูู ุงูุฏุฑุงุณู               โ      โ      โ
ุงูุณุฌู ุงูุฃูุงุฏููู              โ      โ      โ
ุงููุณุชูุฏุงุช                    โ      โ      โ
ุงููุณุงุนุฏ ุงูุฐูู                โ      โ      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ููุญุฉ ุงููุดุฑู                  โ      โ      โ
ุงูููุงููุฉ ุนูู ุทูุจุงุช ุงูุชุณุฌูู   โ      โ      โ
ุนุฑุถ ุจูุงูุงุช ุงูุทูุงุจ            โ      โ      โ
ุชุตุฏูุฑ ุงูุชูุงุฑูุฑ               โ      โ      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุฅุฏุงุฑุฉ ุงููุธุงู ุงููุงููุฉ          โ      โ      โ
ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู             โ      โ      โ
ุฅุฏุงุฑุฉ ุงูููุฑุฑุงุช               โ      โ      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐งช **ุงุฎุชุจุงุฑ ูุธุงู ุงูุตูุงุญูุงุช:**

### **ุงุฎุชุจุงุฑ 1: ุทุงูุจ ูุญุงูู ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู**

```
ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ูุทุงูุจ:
   - ุงูุจุฑูุฏ: student@kku.edu.sa
   - ูููุฉ ุงููุฑูุฑ: Student@123

2. ุญุงูู ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู:
   - ุงุถุบุท ุนูู "ููุญุฉ ุงููุดุฑู" ูู ุงููุงุฆูุฉ
   - ุฃู ุญุงูู ุงููุตูู ูุจุงุดุฑุฉ

ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ
โ ูุธูุฑ ุดุงุดุฉ "ุฌุงุฑู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช..."
โ ูุธูุฑ "Access Denied - ุบูุฑ ูุตุฑุญ ูู ุจุงูุฏุฎูู"
โ ููุญูููู ุชููุงุฆูุงู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
โ ุฑุณุงูุฉ ูู Console: "User role 'student' not authorized"

ุงูุญุงูุฉ: โ ูุธุงู ุงูุญูุงูุฉ ูุนูู!
```

### **ุงุฎุชุจุงุฑ 2: ูุดุฑู ูุฏุฎู ูููุญุฉ ุงููุดุฑู**

```
ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ููุดุฑู:
   - ุงูุจุฑูุฏ: supervisor@kku.edu.sa
   - ูููุฉ ุงููุฑูุฑ: Supervisor@123

2. ุงุฏุฎู ูููุญุฉ ุงููุดุฑู:
   - ุงุถุบุท ุนูู "ููุญุฉ ุงููุดุฑู"

ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ
โ ูุธูุฑ ุดุงุดุฉ "ุฌุงุฑู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช..."
โ ูุธูุฑ "Access granted" ูู Console
โ ุชูุชุญ ููุญุฉ ุงููุดุฑู ุจูุฌุงุญ
โ ูููู ุฑุคูุฉ ุทูุจุงุช ุงูุชุณุฌูู
โ ูููู ุงูููุงููุฉ/ุงูุฑูุถ

ุงูุญุงูุฉ: โ ูุธุงู ุงูุตูุงุญูุงุช ูุนูู!
```

### **ุงุฎุชุจุงุฑ 3: ูุฏูุฑ ูู ูู ุงูุตูุงุญูุงุช**

```
ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ููุฏูุฑ:
   - ุงูุจุฑูุฏ: admin@kku.edu.sa
   - ูููุฉ ุงููุฑูุฑ: Admin@123

2. ุฌุฑุจ ุฌููุน ุงูุตูุญุงุช

ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ
โ ุงููุตูู ูุฌููุน ุงูุตูุญุงุช
โ ูู ุงููุธุงุฆู ุชุนูู
โ ูุง ุชูุฌุฏ ูููุฏ

ุงูุญุงูุฉ: โ ุตูุงุญูุงุช ุงููุฏูุฑ ูุงููุฉ!
```

---

## ๐ง **ููููุฉ ุงูุชุทุจูู ูู ุงูุตูุญุงุช:**

### **ูุซุงู 1: ุญูุงูุฉ ููุญุฉ ุงููุดุฑู**

```tsx
// ูู App.tsx ุฃู ุงูุตูุญุฉ ุงููุญููุฉ:
import { ProtectedRoute } from './components/ProtectedRoute';

// ุงุณุชุฎุฏุงู:
<ProtectedRoute
  requireAuth={true}
  requireAgreement={true}
  allowedRoles={['supervisor', 'admin']}
>
  <SupervisorDashboard />
</ProtectedRoute>
```

### **ูุซุงู 2: ุญูุงูุฉ ุตูุญุฉ ุงูุทูุงุจ ููุท**

```tsx
<ProtectedRoute
  requireAuth={true}
  allowedRoles={['student']}
>
  <StudentOnlyPage />
</ProtectedRoute>
```

### **ูุซุงู 3: ุตูุญุฉ ูููุฏูุฑ ููุท**

```tsx
<ProtectedRoute
  requireAuth={true}
  allowedRoles={['admin']}
>
  <AdminPanel />
</ProtectedRoute>
```

### **ูุซุงู 4: ุตูุญุฉ ููุฌููุน (ูุณุฌูู ุงูุฏุฎูู)**

```tsx
<ProtectedRoute
  requireAuth={true}
  allowedRoles={['student', 'supervisor', 'admin']}
>
  <CoursesPage />
</ProtectedRoute>
```

---

## ๐ **ุชุณุฌูู ุงูุฃุฏูุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**

### **ุนูุฏ ุงูุชุณุฌูู ุงูุฌุฏูุฏ:**

```typescript
// ูู SignUpPage.tsx:
const [formData, setFormData] = useState({
  fullName: '',
  studentId: '',
  email: '',
  password: '',
  major: '',
  level: '',
  role: 'student', // ุงูุฏูุฑ ุงูุงูุชุฑุงุถู
});

// ูููุดุฑู ุฃู ุงููุฏูุฑุ ูุฌุจ ุชุบููุฑ role:
role: 'supervisor'  // ูููุดุฑู
role: 'admin'       // ูููุฏูุฑ
```

### **ูู Backend (server/index.tsx):**

```typescript
const studentData = {
  student_id: studentId,
  full_name: fullName,
  email,
  major,
  level: parseInt(level),
  gpa: gpa ? parseFloat(gpa) : null,
  role: role || 'student', // โ ูุญูุธ ุงูุฏูุฑ
  auth_id: authData.user.id,
  created_at: new Date().toISOString(),
};

await kv.set(`student:${studentId}`, studentData);
```

---

## ๐ **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูู Backend:**

### **ูู ููุญุฉ ุงููุดุฑู:**

```typescript
app.get('/make-server-1573e40a/supervisor/pending-registrations', async (c) => {
  try {
    // 1. ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
    const accessToken = c.req.header('Authorization')?.split(' ')[1];
    if (!accessToken) {
      return c.json({ error: 'Unauthorized' }, 401);
    }

    // 2. ุงูุญุตูู ุนูู ุงููุณุชุฎุฏู
    const { data: { user }, error: authError } = await supabase.auth.getUser(accessToken);
    if (authError || !user) {
      return c.json({ error: 'Unauthorized' }, 401);
    }

    // 3. ุงูุชุญูู ูู ุงูุฏูุฑ โ
    const studentId = await kv.get(`auth:${user.id}`);
    const studentData = await kv.get(`student:${studentId}`);
    
    if (studentData.role !== 'supervisor' && studentData.role !== 'admin') {
      return c.json({ error: 'Forbidden: Supervisor access required' }, 403);
    }

    // โ ูุตุฑุญ ูู - ุชูููุฐ ุงููุธููุฉ
    // ...
  }
});
```

---

## ๐ **ุชุฏูู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช:**

```
ุงููุณุชุฎุฏู ูุญุงูู ุงููุตูู ูุตูุญุฉ ูุญููุฉ
          โ
    ProtectedRoute Component
          โ
1๏ธโฃ ูู ูุจู ุงูุชุนูุฏุ
   โ โ ุฅุนุงุฏุฉ ุชูุฌูู ูุตูุญุฉ ุงูุชุนูุฏ
   โ โ ุงูุชุงูู
          โ
2๏ธโฃ ูู ุณุฌู ุฏุฎููุ
   โ โ ุฅุนุงุฏุฉ ุชูุฌูู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
   โ โ ุงูุชุงูู
          โ
3๏ธโฃ ูู ุฏูุฑู ูุณููุญุ
   โ โ Access Denied + ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ
   โ โ ุงูุณูุงุญ ุจุงูุฏุฎูู
          โ
    โ ุนุฑุถ ุงููุญุชูู
```

---

## ๐ฏ **ุญุงูุงุช ุงูุงุณุชุฎุฏุงู:**

### **ุญุงูุฉ 1: ุทุงูุจ ุนุงุฏู**
```
1. ููุจู ุงูุชุนูุฏ
2. ูุณุฌู ุญุณุงุจ ุฌุฏูุฏ (role: student)
3. ูุณุฌู ุฏุฎูู
4. ููููู:
   โ ุนุฑุถ ุงูููุฑุฑุงุช
   โ ุงูุชุณุฌูู ูู ุงูููุฑุฑุงุช
   โ ุนุฑุถ ุฌุฏููู
   โ ุนุฑุถ ุณุฌูู ุงูุฃูุงุฏููู
5. ูุง ููููู:
   โ ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู
```

### **ุญุงูุฉ 2: ูุดุฑู ุฃูุงุฏููู**
```
1. ููุจู ุงูุชุนูุฏ
2. ูุณุฌู ุญุณุงุจ (role: supervisor)
3. ูุณุฌู ุฏุฎูู
4. ููููู:
   โ ูู ูุง ูููู ููุทุงูุจ
   โ ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู
   โ ุงูููุงููุฉ ุนูู ุงูุทูุจุงุช
```

### **ุญุงูุฉ 3: ูุฏูุฑ**
```
1. ููุจู ุงูุชุนูุฏ
2. ูุณุฌู ุญุณุงุจ (role: admin)
3. ูุณุฌู ุฏุฎูู
4. ููููู:
   โ ูู ุดูุก ุจุฏูู ูููุฏ
```

---

## ๐ฑ **ูุงุฌูุฉ ุงููุณุชุฎุฏู ุญุณุจ ุงูุฏูุฑ:**

### **ููุทุงูุจ:**
```
Navigation:
โ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
โ ุงูููุฑุฑุงุช
โ ุงูุฌุฏูู ุงูุฏุฑุงุณู
โ ุงูุณุฌู ุงูุฃูุงุฏููู
โ ุงููุณุชูุฏุงุช
โ ุงููุณุงุนุฏ ุงูุฐูู
โ ููุญุฉ ุงููุดุฑู (ูุฎููุฉ)
```

### **ูููุดุฑู:**
```
Navigation:
โ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
โ ุงูููุฑุฑุงุช
โ ุงูุฌุฏูู ุงูุฏุฑุงุณู
โ ุงูุณุฌู ุงูุฃูุงุฏููู
โ ุงููุณุชูุฏุงุช
โ ุงููุณุงุนุฏ ุงูุฐูู
โ ููุญุฉ ุงููุดุฑู โญ (ุธุงูุฑุฉ)
```

### **ูููุฏูุฑ:**
```
Navigation:
โ ุฌููุน ุงูุฎูุงุฑุงุช
โ ููุญุฉ ุงููุดุฑู
โ ููุญุฉ ุงูุฅุฏุงุฑุฉ (ุฅุฐุง ููุฌุฏุช)
```

---

## โ **ุฎุทูุงุช ุงูุชูุนูู ุงููุงููุฉ:**

### **ุฎุทูุฉ 1: ุฅูุดุงุก ุงูุญุณุงุจุงุช**

```javascript
// ูู Console ุฃู ูู ุฎูุงู ุงูุชุณุฌูู:

// ุทุงูุจ:
role: 'student'
studentId: '442012345'
email: 'student@kku.edu.sa'

// ูุดุฑู:
role: 'supervisor'
studentId: '442999001'
email: 'supervisor@kku.edu.sa'

// ูุฏูุฑ:
role: 'admin'
studentId: '442999999'
email: 'admin@kku.edu.sa'
```

### **ุฎุทูุฉ 2: ุงูุชุญูู ูู ุงูุตูุงุญูุงุช**

```typescript
// ูู ูู ุตูุญุฉ ูุญููุฉุ ุงุณุชุฎุฏู:
<ProtectedRoute
  requireAuth={true}
  requireAgreement={true}
  allowedRoles={['supervisor', 'admin']} // ุญุณุจ ุงูุญุงุฌุฉ
>
  {/* ุงููุญุชูู */}
</ProtectedRoute>
```

### **ุฎุทูุฉ 3: ุงูุงุฎุชุจุงุฑ**

```
1. โ ุณุฌู ุฏุฎูู ูุทุงูุจ โ ุญุงูู ุงูุฏุฎูู ูููุญุฉ ุงููุดุฑู โ ููุฑูุถ
2. โ ุณุฌู ุฏุฎูู ููุดุฑู โ ุงุฏุฎู ูููุญุฉ ุงููุดุฑู โ ููุณูุญ
3. โ ุณุฌู ุฏุฎูู ููุฏูุฑ โ ุงุฏุฎู ูุฃู ููุงู โ ููุณูุญ
```

---

## ๐ **ุงูุญุงูุฉ ุงูููุงุฆูุฉ:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ูุธุงู ูุตู ุงูุตูุงุญูุงุช ูุดุท ููุนูู 100%
โ 3 ุฃุฏูุงุฑ ูุญุฏุฏุฉ ุจูุถูุญ
โ ุญูุงูุฉ ูุงููุฉ ููุตูุญุงุช ุงููุญููุฉ
โ ุงูุชุญูู ูู Frontend ู Backend
โ ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู
โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ
โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ

๐ ุงูุชูููู: ููุชุงุฒ (Excellent)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

# ๐ **ุงููุธุงู ุฌุงูุฒ ูุขูู!**

**ยฉ 2025 ุฌุงูุนุฉ ุงูููู ุฎุงูุฏ - ูุธุงู ูุตู ุงูุตูุงุญูุงุช**  
**ุงูุญุงูุฉ:** โ **ูุดุท ููููุนูู**  
**ุงูุฃูุงู:** ๐ **ุนุงูู ุฌุฏุงู**
