# 🎬 شرح مصوّر بالخطوات - نشر Edge Function

## 📸 دليل بالصور (خطوة بخطوة)

---

## الخطوة 1️⃣: فتح Supabase Dashboard

### ما تفعله:
1. افتح متصفحك
2. اذهب إلى: `https://supabase.com/dashboard`
3. سجل الدخول

### ما تراه:
```
┌─────────────────────────────────────────┐
│  🟢 Supabase Dashboard                  │
│                                         │
│  Your Projects:                         │
│  ├─ 📁 kcbxyonombsqamwsmmqz            │
│  └─ 📁 Project 2                       │
└─────────────────────────────────────────┘
```

### اضغط على:
```
📁 kcbxyonombsqamwsmmqz
```

---

## الخطوة 2️⃣: الذهاب إلى Edge Functions

### ما تراه (القائمة الجانبية):
```
┌─────────────────────┐
│ Project Settings    │
├─────────────────────┤
│ 📊 Dashboard        │
│ 🔐 Authentication   │
│ 🗄️ Database         │
│ 📦 Storage          │
│ ⚡ Edge Functions   │ ← اضغط هنا!
│ 📈 Reports          │
│ ⚙️ Settings         │
└─────────────────────┘
```

### اضغط على:
```
⚡ Edge Functions
```

---

## الخطوة 3️⃣: إنشاء Function جديدة

### ما تراه:
```
┌─────────────────────────────────────────────┐
│  Edge Functions                             │
│                                             │
│  No functions yet                           │
│                                             │
│  [+ Create a new function]  ← اضغط هنا!   │
└─────────────────────────────────────────────┘
```

### اضغط على:
```
+ Create a new function
```

### نافذة منبثقة ستظهر:
```
┌─────────────────────────────────────────┐
│  Create a new function                  │
│                                         │
│  Function name:                         │
│  ┌───────────────────────────────────┐ │
│  │ make-server-1573e40a             │ │ ← اكتب هذا بالضبط!
│  └───────────────────────────────────┘ │
│                                         │
│  [Cancel]  [Create function]            │
└─────────────────────────────────────────┘
```

### اكتب بالضبط:
```
make-server-1573e40a
```

⚠️ **انسخه من ملف:** `📋-معلومات-النسخ-السريع.txt`

### اضغط:
```
Create function
```

---

## الخطوة 4️⃣: نشر الكود

### ما تراه بعد الإنشاء:
```
┌─────────────────────────────────────────────────┐
│  make-server-1573e40a                           │
│                                                 │
│  [Deploy]  [Settings]  [Logs]                  │
│                                                 │
│  ┌───────────────────────────────────────────┐ │
│  │ // Deno function                          │ │
│  │ // Write your code here...                │ │
│  │                                           │ │
│  │                                           │ │
│  └───────────────────────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

### ما تفعله:
1. **احذف** أي كود موجود في المحرر
2. **افتح** في Figma Make: `/supabase/functions/server/index.tsx`
3. **اضغط Ctrl+A** (لتحديد الكل)
4. **اضغط Ctrl+C** (لنسخ)
5. **ارجع** لـ Supabase Dashboard
6. **اضغط Ctrl+V** (للصق الكود)
7. **اضغط** على زر **Deploy**

### شكل الزر:
```
┌─────────────┐
│   Deploy    │ ← اضغط هنا بعد اللصق!
└─────────────┘
```

### ما ستراه أثناء النشر:
```
┌─────────────────────────────────┐
│  Deploying function...          │
│  ████████████░░░░░░░░░  60%     │
└─────────────────────────────────┘
```

⏳ **انتظر** حتى ينتهي (30-60 ثانية)

### عند النجاح:
```
✅ Function deployed successfully!
```

---

## الخطوة 5️⃣: إضافة Environment Variables

### اضغط على:
```
[Settings] ← في الأعلى
```

### ما تراه:
```
┌─────────────────────────────────────────────┐
│  Function Settings                          │
│                                             │
│  Environment Variables                      │
│  ┌───────────────────────────────────────┐ │
│  │ No environment variables yet          │ │
│  └───────────────────────────────────────┘ │
│                                             │
│  [+ Add new secret]  ← اضغط هنا!          │
└─────────────────────────────────────────────┘
```

### أضف المتغير الأول:

#### نافذة ستظهر:
```
┌─────────────────────────────────────┐
│  Add environment variable           │
│                                     │
│  Name:                              │
│  ┌─────────────────────────────┐   │
│  │ SUPABASE_URL                │   │
│  └─────────────────────────────┘   │
│                                     │
│  Value:                             │
│  ┌─────────────────────────────┐   │
│  │ https://kcbxyono...         │   │
│  └─────────────────────────────┘   │
│                                     │
│  [Cancel]  [Add]                    │
└─────────────────────────────────────┘
```

#### اكتب:
```
Name: SUPABASE_URL
Value: https://kcbxyonombsqamwsmmqz.supabase.co
```

#### اضغط: `Add`

---

### أضف المتغير الثاني:

#### اضغط مرة أخرى:
```
[+ Add new secret]
```

#### اكتب:
```
Name: SUPABASE_ANON_KEY
Value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtjYnh5b25vbWJzcWFtd3NtbXF6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzNzA3OTMsImV4cCI6MjA3OTk0Njc5M30.IR1b_sKmNZnPHSx_EBTI0G5ouARblxMepr24nOxq8iM
```

#### اضغط: `Add`

---

### أضف المتغير الثالث (الأهم):

#### اضغط مرة أخرى:
```
[+ Add new secret]
```

#### اكتب:
```
Name: SUPABASE_SERVICE_ROLE_KEY
Value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtjYnh5b25vbWJzcWFtd3NtbXF6Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NDM3MDc5MywiZXhwIjoyMDc5OTQ2NzkzfQ.5cgLm3CjLP0NzGE6riqoZTtABW1wljEEJ7iH0XAeJR0
```

#### اضغط: `Add`

---

### ما ستراه بعد إضافة الثلاث متغيرات:
```
┌─────────────────────────────────────────────┐
│  Environment Variables                      │
│                                             │
│  ✅ SUPABASE_URL                            │
│  ✅ SUPABASE_ANON_KEY                       │
│  ✅ SUPABASE_SERVICE_ROLE_KEY               │
└─────────────────────────────────────────────┘
```

⚠️ **ملاحظة:** قد تحتاج إعادة نشر Function بعد إضافة المتغيرات

---

## الخطوة 6️⃣: اختبار النشر

### افتح متصفح جديد (أو تبويب جديد)

### اكتب في شريط العنوان:
```
https://kcbxyonombsqamwsmmqz.supabase.co/functions/v1/make-server-1573e40a/health
```

⚠️ **انسخه من:** `📋-معلومات-النسخ-السريع.txt`

### اضغط Enter

---

### ✅ النجاح - ستشاهد:
```json
{
  "status": "ok",
  "message": "KKU Course Registration System - SQL Database",
  "database": "PostgreSQL via Supabase"
}
```

### 🎉 **تهانينا! Edge Function تعمل!**

---

### ❌ الفشل - قد تشاهد:

#### خطأ 404:
```json
{
  "error": "Function not found"
}
```
**الحل:** Function غير منشورة، راجع الخطوة 3 و 4

---

#### خطأ 500:
```json
{
  "error": "Internal Server Error"
}
```
**الحل:** Environment Variables ناقصة، راجع الخطوة 5

---

#### صفحة فارغة أو Timeout:
```
⏳ Loading...
```
**الحل:** انتظر قليلاً، أو أعد تحميل الصفحة

---

## الخطوة 7️⃣: اختبار التطبيق

### افتح التطبيق في Figma Make

### اذهب إلى صفحة إنشاء حساب:
```
┌─────────────────────────────────────┐
│  🎓 نظام تسجيل المقررات            │
│                                     │
│  تسجيل الدخول  |  إنشاء حساب ← هنا │
└─────────────────────────────────────┘
```

---

### املأ النموذج:
```
┌───────────────────────────────────────────┐
│  إنشاء حساب جديد                         │
│                                           │
│  الرقم الجامعي: *                        │
│  ┌─────────────────────────────────────┐ │
│  │ 443123456                           │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  البريد الإلكتروني: *                   │
│  ┌─────────────────────────────────────┐ │
│  │ test@student.kku.edu.sa             │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  كلمة المرور: *                          │
│  ┌─────────────────────────────────────┐ │
│  │ Test123456                          │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  الاسم الكامل: *                         │
│  ┌─────────────────────────────────────┐ │
│  │ اختبار النظام                       │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  رقم الجوال: *                           │
│  ┌─────────────────────────────────────┐ │
│  │ 0500000000                          │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  الدور: *                                │
│  ┌─────────────────────────────────────┐ │
│  │ طالب                         [▼]   │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  التخصص: *                               │
│  ┌─────────────────────────────────────┐ │
│  │ نظم المعلومات الإدارية      [▼]   │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  المستوى الدراسي: *                     │
│  ┌─────────────────────────────────────┐ │
│  │ 1                            [▼]   │ │
│  └─────────────────────────────────────┘ │
│                                           │
│  [ إنشاء حساب ]  ← اضغط هنا!            │
└───────────────────────────────────────────┘
```

---

### اضغط: `إنشاء حساب`

---

### ✅ النجاح:
```
┌─────────────────────────────────────┐
│  ✅ تم إنشاء الحساب بنجاح!         │
│                                     │
│  جاري تحويلك للوحة التحكم...       │
└─────────────────────────────────────┘
```

### 🎉 **مبروك! النظام يعمل 100%!**

---

### ❌ الفشل:

#### إذا ظهر:
```
❌ Failed to fetch
```
**السبب:** Edge Function غير منشورة
**الحل:** راجع الخطوات 3-5

---

#### إذا ظهر:
```
❌ Email already exists
```
**السبب:** البريد مستخدم من قبل
**الحل:** استخدم بريد آخر أو اذهب لصفحة "أدوات النظام" لحذف الحساب

---

#### إذا ظهر:
```
❌ Student data incomplete
```
**السبب:** لم تختر التخصص أو المستوى
**الحل:** تأكد من اختيارهما

---

## 🎊 النتيجة النهائية

### بعد النجاح، ستشاهد:
```
┌─────────────────────────────────────────┐
│  🎓 لوحة التحكم - طالب                 │
│                                         │
│  مرحباً، اختبار النظام                │
│  الرقم الجامعي: 443123456              │
│  المستوى: 1                             │
│  التخصص: نظم المعلومات الإدارية        │
│  المعدل التراكمي: 0.00                 │
│                                         │
│  ┌───────────────────────────────────┐ │
│  │  📚 المقررات المتاحة             │ │
│  │  ✅ 6 مقررات للمستوى الأول       │ │
│  └───────────────────────────────────┘ │
│                                         │
│  [عرض المقررات]  [الجدول الدراسي]    │
└─────────────────────────────────────────┘
```

---

## 🏆 تهانينا!

### ✅ أكملت جميع الخطوات
### ✅ النظام يعمل 100%
### ✅ المشروع جاهز للعرض
### ✅ مشروع تخرج مميز!

---

## 📝 ملخص ما أنجزته:

1. ✅ قاعدة بيانات جديدة نظيفة
2. ✅ 13 جدول
3. ✅ 9 أقسام أكاديمية
4. ✅ 49 مقرر دراسي
5. ✅ نشر Edge Function
6. ✅ إضافة Environment Variables
7. ✅ اختبار النظام بنجاح
8. ✅ نظام متكامل يعمل!

---

## 🎯 الخطوات التالية:

1. **أنشئ حساب مدير:**
   - الدور: `مدير`
   - لإدارة النظام بالكامل

2. **أنشئ حساب مشرف:**
   - الدور: `مشرف أكاديمي`
   - لاختبار ميزات المشرف

3. **اختبر جميع الميزات:**
   - تسجيل مقررات
   - عرض الجدول
   - حساب المعدل
   - السجل الأكاديمي
   - المساعد الذكي

4. **جهز العرض التقديمي!** 🎤

---

**مبروك على المشروع الناجح!** 🎉🎊🎈
