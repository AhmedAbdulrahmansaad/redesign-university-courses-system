# ๐ฏ ุฎุทูุงุช ุฑุจุท ูุงุนุฏุฉ ุงูุจูุงูุงุช - ุฏููู ุณุฑูุน

## โ ูุง ุชู ุฅุตูุงุญู

### 1. **ุฅุถุงูุฉ ุฌุฏูู Enrollments ูุชุณุฌูู ุงูููุฑุฑุงุช**
   - ุชู ุฅุถุงูุฉ ุฌุฏูู `enrollments` ูู ููู `database_setup.sql`
   - ุงูุฌุฏูู ูุญุชูู ุนูู ุฌููุน ุงูุญููู ุงููุทููุจุฉ (user_id, course_id, status, semester, year...)

### 2. **ุฅุถุงูุฉ Endpoints ููุชุณุฌูู ูู ุงูููุฑุฑุงุช**
   - โ `POST /make-server-1573e40a/register-course` - ุชุณุฌูู ุทุงูุจ ูู ููุฑุฑ
   - โ `GET /make-server-1573e40a/student/registrations` - ุฌูุจ ุชุณุฌููุงุช ุงูุทุงูุจ
   - โ `DELETE /make-server-1573e40a/student/registrations/:id` - ุฅูุบุงุก ุชุณุฌูู
   - โ `GET /make-server-1573e40a/courses/available` - ุฌูุจ ุงูููุฑุฑุงุช ุงููุชุงุญุฉ ููุทุงูุจ

### 3. **ุชุญุณูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช**
   - ุชุญููู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุชูุงุณุจ ูุน ุงูู Interface ูู ุงูู Frontend
   - ุฏุนู ูู ูู `course_id` (string) ู `id` (number)

---

## ๐ ุงูุฎุทูุงุช ุงููุทููุจุฉ ููู

### ุงูุฎุทูุฉ 1: ุชุดุบูู SQL Script ูุฅูุดุงุก ุงูุฌุฏุงูู

ูู ุจุชุดุบูู ููู `database_setup.sql` ูู Supabase:

```bash
1. ุงูุชุญ ูุดุฑูุนู ูู Supabase Dashboard
2. ุงุฐูุจ ุฅูู SQL Editor
3. ุงูุณุฎ ูุญุชูู ููู database_setup.sql
4. ุงูุตู ุงููุญุชูู ูู SQL Editor
5. ุงุถุบุท ุนูู "Run"
```

**โจ ูุฐุง ุณูููู ุจุฅูุดุงุก ุฌููุน ุงูุฌุฏุงูู ุงููุทููุจุฉ:**
- โ departments
- โ users
- โ students
- โ supervisors
- โ admins
- โ courses
- โ course_offerings
- โ **enrollments** (ุงูุฌุฏูู ุงูุฌุฏูุฏ ููุชุณุฌููุงุช)

---

### ุงูุฎุทูุฉ 2: ุฅุฏุฎุงู ุจูุงูุงุช ุงูููุฑุฑุงุช

ุจุนุฏ ุฅูุดุงุก ุงูุฌุฏุงููุ ุชุญุชุงุฌ ุฅูู ุฅุฏุฎุงู ุงูููุฑุฑุงุช ุงูุฏุฑุงุณูุฉ. ููููู ุงุณุชุฎุฏุงู ุฃุญุฏ ุงููููุงุช ุงูุชุงููุฉ:

- `sample_courses_data.sql` - ุจูุงูุงุช ุงูููุฑุฑุงุช ุงูุฃุณุงุณูุฉ
- `๐ฅ-INSERT-COURSES.sql` - ุจูุงูุงุช ุงูููุฑุฑุงุช ุงูู 49 ููุฑุฑุงู

**ุงุฎุชุฑ ุฃุญุฏ ุงููููุงุช ููู ุจุชุดุบููู:**

```sql
-- ูู SQL Editor
-- ุงูุณุฎ ูุญุชูู ุงูููู ูุดุบูู
```

---

### ุงูุฎุทูุฉ 3: ูุดุฑ Edge Function ุงููุญุฏุซุฉ

ูู ุจูุดุฑ ุงูู Edge Function ุงููุญุฏุซุฉ ุงูุชู ุชุญุชูู ุนูู ุงูู Endpoints ุงูุฌุฏูุฏุฉ:

```bash
# ูู Terminal
npx supabase functions deploy make-server-1573e40a
```

**ููุงุญุธุฉ:** ุชุฃูุฏ ูู ุฃู ููู `supabase/functions/server/index.tsx` ูุญุฏุซ ุจุฃุญุฏุซ ุงูู endpoints.

---

### ุงูุฎุทูุฉ 4: ุงุฎุชุจุงุฑ ุงููุธุงู

#### 4.1 ุฅูุดุงุก ุญุณุงุจ ุทุงูุจ ุฌุฏูุฏ

```
1. ุงุฐูุจ ูุตูุญุฉ "ุฅูุดุงุก ุญุณุงุจ" (Sign Up)
2. ุฃุฏุฎู ุงูุจูุงูุงุช ุงูุชุงููุฉ:
   - ุงูุฑูู ุงูุฌุงูุนู: 4200001
   - ุงูุงุณู: ุฃุญูุฏ ูุญูุฏ
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: student@test.com
   - ูููุฉ ุงููุฑูุฑ: Test@123
   - ุงููุณุชูู: 1
   - ุงูุชุฎุตุต: ูุธู ุงููุนูููุงุช ุงูุฅุฏุงุฑูุฉ
3. ุงุถุบุท "ุฅูุดุงุก ุญุณุงุจ"
```

**โ ุงููุชููุน:** ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ ูุฃู ููุญูุธ ุงููุณุชุฎุฏู ูู:
- โ ุฌุฏูู `auth.users` ูู Supabase
- โ ุฌุฏูู `users`
- โ ุฌุฏูู `students`

**๐ ููุชุญูู:**
```sql
-- ูู SQL Editor
SELECT * FROM users WHERE student_id = '4200001';
SELECT * FROM students WHERE user_id = (SELECT id FROM users WHERE student_id = '4200001');
```

#### 4.2 ุชุณุฌูู ุงูุฏุฎูู

```
1. ุงุฐูุจ ูุตูุญุฉ "ุชุณุฌูู ุงูุฏุฎูู" (Login)
2. ุฃุฏุฎู:
   - ุงูุจุฑูุฏ: student@test.com
   - ูููุฉ ุงููุฑูุฑ: Test@123
3. ุงุถุบุท "ุชุณุฌูู ุงูุฏุฎูู"
```

**โ ุงููุชููุน:** ูุฌุจ ุงูุงูุชูุงู ุฅูู ููุญุฉ ุชุญูู ุงูุทุงูุจ.

#### 4.3 ุนุฑุถ ุงูููุฑุฑุงุช

```
1. ูู ููุญุฉ ุงูุชุญููุ ุงุฐูุจ ุฅูู "ุงูููุฑุฑุงุช ุงููุชุงุญุฉ"
2. ูุฌุจ ุฃู ุชุธูุฑ ูุงุฆูุฉ ุงูููุฑุฑุงุช
```

**โ ุงููุชููุน:** 
- ุฅุฐุง ูุงูุช ุงูููุฑุฑุงุช ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: ุณุชุธูุฑ ูู SQL Database
- ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ: ุณุชุธูุฑ 5 ููุฑุฑุงุช ุชุฌุฑูุจูุฉ (hardcoded)

#### 4.4 ุชุณุฌูู ููุฑุฑ

```
1. ุงุฎุชุฑ ุฃู ููุฑุฑ
2. ุงุถุบุท ุนูู "ุณุฌู ุงูุขู"
3. ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ
```

**โ ุงููุชููุน:** 
- ุธููุฑ ุฑุณุงูุฉ: "ุชู ุชุณุฌููู ูู ุงูููุฑุฑ ุจูุฌุงุญ. ูู ุงูุชุธุงุฑ ููุงููุฉ ุงููุดุฑู ุงูุฃูุงุฏููู"
- ุญูุธ ุงูุชุณุฌูู ูู ุฌุฏูู `enrollments`

**๐ ููุชุญูู:**
```sql
-- ูู SQL Editor
SELECT 
  e.*,
  u.name as student_name,
  c.code as course_code,
  c.name_ar as course_name
FROM enrollments e
JOIN users u ON e.user_id = u.id
JOIN courses c ON e.course_id = c.id
WHERE u.student_id = '4200001';
```

---

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### โ ูุดููุฉ: "Failed to fetch courses"

**ุงูุญู:**
1. ุชุญูู ูู ูุฌูุฏ ุงูููุฑุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
   ```sql
   SELECT COUNT(*) FROM courses;
   ```
2. ุฅุฐุง ูุงูุช ุงููุชูุฌุฉ 0ุ ูู ุจุชุดุบูู ููู `sample_courses_data.sql`

---

### โ ูุดููุฉ: "Failed to register for course"

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**

**1. ุฌุฏูู enrollments ุบูุฑ ููุฌูุฏ:**
```sql
-- ุชุญูู ูู ูุฌูุฏ ุงูุฌุฏูู
SELECT * FROM enrollments LIMIT 1;
```
ุฅุฐุง ุธูุฑ ุฎุทุฃุ ูู ุจุชุดุบูู ููู `database_setup.sql` ูุฑุฉ ุฃุฎุฑู.

**2. ุงูููุฑุฑ ุบูุฑ ููุฌูุฏ:**
```sql
-- ุชุญูู ูู ูุฌูุฏ ุงูููุฑุฑ
SELECT * FROM courses WHERE id = 1;
```

**3. ุงููุณุชุฎุฏู ููุณ ุทุงูุจุงู:**
```sql
-- ุชุญูู ูู ุฏูุฑ ุงููุณุชุฎุฏู
SELECT role FROM users WHERE student_id = '4200001';
```
ูุฌุจ ุฃู ูููู ุงูุฏูุฑ = 'student'

---

### โ ูุดููุฉ: "User already registered for this course"

**ุงูุญู:**
```sql
-- ุงุญุฐู ุงูุชุณุฌูู ุงููุฏูู
DELETE FROM enrollments 
WHERE user_id = (SELECT id FROM users WHERE student_id = '4200001')
AND course_id = 1;
```

---

### โ ูุดููุฉ: ุฅูุดุงุก ุงูุญุณุงุจ ูุง ูุธูุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุญู:**

1. **ุชุญูู ูู Console ูู ุงููุชุตูุญ:**
   - ุงูุชุญ Developer Tools (F12)
   - ุงุฐูุจ ูุชุจููุจ Console
   - ุงุจุญุซ ุนู ุฑุณุงุฆู ุชุจุฏุฃ ุจู `[Signup]`

2. **ุชุญูู ูู Logs ูู Supabase:**
   - ุงุฐูุจ ุฅูู Supabase Dashboard
   - ุงูุชุญ Edge Functions
   - ุงุฎุชุฑ `make-server-1573e40a`
   - ุงุฐูุจ ูุชุจููุจ Logs

3. **ุชุญูู ูู ุงููุณุชุฎุฏููู ุงููุชุงูู:**
   ```sql
   -- ูู SQL Editor
   SELECT * FROM auth.users;
   SELECT * FROM users;
   ```
   ุฅุฐุง ูุฌุฏุช ูุณุชุฎุฏู ูู `auth.users` ููู ููุณ ูู `users`ุ ููู ูุณุชุฎุฏู ูุชูู.

4. **ุชูุธูู ุงููุณุชุฎุฏููู ุงููุชุงูู:**
   ุงุณุชุฎุฏู ุตูุญุฉ "ุฃุฏูุงุช ุงููุธุงู" ูู ุงูุชุทุจููุ ุฃู ูู ุจุชุดุบูู:
   ```bash
   curl -X POST https://YOUR_PROJECT_ID.supabase.co/functions/v1/make-server-1573e40a/public/cleanup-all-orphaned-users \
     -H "Content-Type: application/json" \
     -H "Authorization: Bearer YOUR_ANON_KEY"
   ```

---

## โ ุงูุชุญูู ุงูููุงุฆู

ุจุนุฏ ุงุชุจุงุน ุฌููุน ุงูุฎุทูุงุชุ ุชุญูู ูู:

### 1. ุงูุฌุฏุงูู ููุฌูุฏุฉ:
```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public'
ORDER BY table_name;
```

**ูุฌุจ ุฃู ุชุฑู:**
- โ departments
- โ users
- โ students
- โ supervisors
- โ courses
- โ course_offerings
- โ enrollments

### 2. ุงูุจูุงูุงุช ููุฌูุฏุฉ:
```sql
-- ุนุฏุฏ ุงูุฃูุณุงู
SELECT COUNT(*) as departments FROM departments;

-- ุนุฏุฏ ุงูููุฑุฑุงุช
SELECT COUNT(*) as courses FROM courses;

-- ุนุฏุฏ ุงููุณุชุฎุฏููู
SELECT COUNT(*) as users FROM users;

-- ุนุฏุฏ ุงูุชุณุฌููุงุช
SELECT COUNT(*) as enrollments FROM enrollments;
```

### 3. ุงูู Endpoints ุชุนูู:
```bash
# Health Check
curl https://YOUR_PROJECT_ID.supabase.co/functions/v1/make-server-1573e40a/health

# Get Courses
curl https://YOUR_PROJECT_ID.supabase.co/functions/v1/make-server-1573e40a/courses \
  -H "Authorization: Bearer YOUR_ANON_KEY"
```

---

## ๐ ุจุนุฏ ุงูุชูุงู ุงูุฎุทูุงุช

ูุฌุจ ุฃู ูุนูู ุงููุธุงู ุงูุขู ุจุงููุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช:
- โ ุฅูุดุงุก ุญุณุงุจุงุช ุงูุทูุงุจ ููุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุชุณุฌูู ุงูุฏุฎูู ูุนูู ุจุดูู ุตุญูุญ
- โ ุนุฑุถ ุงูููุฑุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุชุณุฌูู ุงูุทูุงุจ ูู ุงูููุฑุฑุงุช ููุญูุธ ูู ุฌุฏูู enrollments
- โ ุฌููุน ุงูุนูููุงุช ูุฑุจูุทุฉ ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญููููุฉ

---

## ๐ ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ

ุฑุงุณููู ูุน:
1. ุฑุณุงูุฉ ุงูุฎุทุฃ ุงููุงููุฉ ูู Console
2. ูุชูุฌุฉ SQL Query ุงูุชุงูู:
   ```sql
   SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';
   SELECT COUNT(*) FROM users;
   SELECT COUNT(*) FROM courses;
   SELECT COUNT(*) FROM enrollments;
   ```
3. Logs ูู Edge Function ูู Supabase Dashboard

**ุฃูุง ุฌุงูุฒ ููุณุงุนุฏุชู!** ๐
