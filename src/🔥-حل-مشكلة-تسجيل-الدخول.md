# ๐ฅ ุญู ูุดููุฉ ุชุณุฌูู ุงูุฏุฎูู - ุฎุทูุฉ ุจุฎุทูุฉ

## โ ุงููุดููุฉ:
ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญุ ููู ูุง ูููู ุชุณุฌูู ุงูุฏุฎูู.

---

## โ ุงูุญู ุงูุณุฑูุน (3 ุฏูุงุฆู):

### ุงูุฎุทูุฉ 1: ุชูุธูู ุงูุญุณุงุจ ุงููุฏูู

ุงูุชุญ Console ูู ุงููุชุตูุญ (ุงุถุบุท F12)ุ ูููุฐ ูุฐุง ุงูููุฏ:

```javascript
// ุชูุธูู ุงูุญุณุงุจ ุงููุชูู
const cleanupOrphanedUser = async () => {
  const email = 'student1@kku.edu.sa'; // ุถุน ุจุฑูุฏู ููุง
  
  const response = await fetch(
    'https://PROJECT_ID.supabase.co/functions/v1/make-server-1573e40a/public/cleanup-orphaned-user',
    {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer YOUR_ANON_KEY'
      },
      body: JSON.stringify({ email })
    }
  );
  
  const result = await response.json();
  console.log('Cleanup result:', result);
  
  if (result.cleaned) {
    alert('โ ุชู ุชูุธูู ุงูุญุณุงุจ! ููููู ุงูุขู ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ');
  } else {
    alert('โน๏ธ ' + result.message);
  }
};

cleanupOrphanedUser();
```

**ููุงุญุธุฉ:** ุงุณุชุจุฏู `PROJECT_ID` ู `YOUR_ANON_KEY` ุจุงูููู ุงูุญููููุฉ ูู `/utils/supabase/info.tsx`

---

### ุงูุฎุทูุฉ 2: ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ

ุจุนุฏ ุชูุธูู ุงูุญุณุงุจ ุงููุฏูู:

1. โ ุงุฐูุจ ูุตูุญุฉ "ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ"
2. โ ุงุณุชุฎุฏู ููุณ ุงูุจูุงูุงุช ุฃู ุจูุงูุงุช ุฌุฏูุฏุฉ
3. โ ุงุถุบุท "ุฅูุดุงุก ุญุณุงุจ"
4. โ ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ

---

### ุงูุฎุทูุฉ 3: ุชุณุฌูู ุงูุฏุฎูู

1. โ ุงุฐูุจ ูุตูุญุฉ "ุชุณุฌูู ุงูุฏุฎูู"
2. โ ุฃุฏุฎู ุงูุจุฑูุฏ ููููุฉ ุงููุฑูุฑ
3. โ ุงุถุบุท "ุชุณุฌูู ุงูุฏุฎูู"
4. โ ูุฌุจ ุฃู ูุนูู ุงูุขู! ๐

---

## ๐ ููู ุชุชุญูู ูู ุงููุดููุฉุ

### ุงูุชุญ Console (F12) ูุดุงูุฏ ุงูุฑุณุงุฆู:

**ุนูุฏ ุฅูุดุงุก ุงูุญุณุงุจุ ูุฌุจ ุฃู ุชุฑู:**
```
๐ [Signup] Received signup request: { email: '...', ... }
โ๏ธ [Signup] Found orphaned auth user, deleting: ...
โ [Signup] Orphaned user deleted
๐ [Signup] Creating auth user...
โ [Signup] Auth user created: ...
โ [Signup] User record created: ...
โ [Signup] Student record created: ...
โ [Signup] User created successfully - can now login
```

**ุนูุฏ ุชุณุฌูู ุงูุฏุฎููุ ูุฌุจ ุฃู ุชุฑู:**
```
๐ [Login] Attempting login for: ...
โ [Login] Supabase auth successful, auth_id: ...
โ [Login] User data fetched successfully: { id: ..., email: ..., role: ... }
```

---

## ๐๏ธ ูุง ุชู ุฅุตูุงุญู ูู ุงูููุฏุ

### 1๏ธโฃ Edge Function (Signup):
- โ ูุชุญูู ูู ูุฌูุฏ ุญุณุงุจ ูุชูู ูุจู ุงูุฅูุดุงุก
- โ ูุญุฐู ุงูุญุณุงุจ ุงููุชูู ุชููุงุฆูุงู
- โ ูุถูู `name_ar` ู `name_en` ููู users table
- โ ูุญูุธ ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ ูู ุฌููุน ุงูุฌุฏุงูู

### 2๏ธโฃ Login Page:
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุตูุฉ
- โ logs ุชูุตูููุฉ ูู Console
- โ ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก

---

## ๐ ูุงุฆูุฉ ุงูุชุญูู:

ุถุน โ ุนูู ูู ุนูุตุฑ:

- [ ] ุชู ุชูุธูู ุงูุญุณุงุจ ุงููุฏูู (ุฅู ูุฌุฏ)
- [ ] ุชู ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ
- [ ] ุธูุฑุช ุฑุณุงูุฉ "ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ"
- [ ] ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู Console
- [ ] ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ
- [ ] ุธูุฑุช ุฑุณุงูุฉ "ูุฑุญุจุงู ..."
- [ ] ุชู ุงูุงูุชูุงู ูููุญุฉ ุงูุชุญูู

---

## โ ุฅุฐุง ูู ุชุญู ุงููุดููุฉ:

### ุงุชุจุน ูุฐู ุงูุฎุทูุงุช:

1. **ุงูุชุญ Supabase Dashboard:**
   - ุงุฐูุจ ุฅูู: https://supabase.com/dashboard
   - ุงุฎุชุฑ ูุดุฑูุนู

2. **ุงูุชุญ Authentication:**
   - ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ โ **Authentication** โ **Users**

3. **ุงุจุญุซ ุนู ุจุฑูุฏู:**
   - ุงุจุญุซ ุนู `student1@kku.edu.sa`

4. **ุงุญุฐู ุงููุณุชุฎุฏู ูู Auth:**
   - ุงุถุบุท ุนูู ุงููุณุชุฎุฏู
   - ุงุถุบุท **Delete User**

5. **ุชุญูู ูู ุฌุฏูู users:**
   - ุงุฐูุจ ุฅูู **Table Editor** โ **users**
   - ุงุจุญุซ ุนู ุจุฑูุฏู
   - ุฅุฐุง ูุงู ููุฌูุฏุ ุงุญุฐูู

6. **ุฃุนุฏ ุฅูุดุงุก ุงูุญุณุงุจ:**
   - ุงุฑุฌุน ูููุธุงู
   - ุฃูุดุฆ ุญุณุงุจ ุฌุฏูุฏ
   - ุณุฌู ุฏุฎูู

---

## ๐ก ูุตูุญุฉ ูููุฉ:

**ูุชุฌูุจ ูุฐู ุงููุดููุฉ ูู ุงููุณุชูุจู:**

ุนูุฏ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ:
1. โ ุงุณุชุฎุฏู ุจุฑูุฏ ุฌุฏูุฏ ููู ูุณุชุฎุฏู
2. โ ูุง ุชุญุงูู ุฅูุดุงุก ุญุณุงุจ ูุฑุชูู ุจููุณ ุงูุจุฑูุฏ
3. โ ุฑุงูุจ Console ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

---

## ๐ฏ ุงูุฎุทูุฉ ุงูุชุงููุฉ:

ุจุนุฏ ุญู ูุดููุฉ ุชุณุฌูู ุงูุฏุฎูู:

**ุฎุจุฑูู:**
- โ ูู ุชูููุช ูู ุชุณุฌูู ุงูุฏุฎููุ
- โ ูู ุธูุฑุช ููุญุฉ ุงูุชุญููุ
- โ ูู ุชุฑู ุงุณูู ูู ุงูุฃุนููุ

**ุฅุฐุง ูุฌุญ ูู ุดูุกุ ุณุฃููู ุงูุฎุทูุฉ 3: ุฑุจุท ุจุงูู ุงูุตูุญุงุช!** ๐

---

**๐ ุงูุชุญุฏูุซ:** ุชู ุฅุตูุงุญ Edge Function ููุญุฐู ุงูุญุณุงุจุงุช ุงููุชููุฉ ุชููุงุฆูุงู!  
**โ ุงูุญุงูุฉ:** ุฌุงูุฒ ููุงุฎุชุจุงุฑ
