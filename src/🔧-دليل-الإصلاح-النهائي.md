# ๐ง ุฏููู ุงูุฅุตูุงุญ ุงูููุงุฆู - ุชูุตูู ุงููุธุงู ุจู Supabase

<div dir="rtl">

## ๐ฏ ุงููุดููุฉ

ุงููุธุงู ุงูุญุงูู ูุนูู ุนูู localStorage ููุทุ ููุง ูุนูู:
- โ ูู ูุชุตูุญ ูู ุจูุงูุงุช ูููุตูุฉ
- โ ุงูุญุณุงุจุงุช ุงููููุดุฃุฉ ุนูู ุฌูุงุฒ ูุง ุชุธูุฑ ุนูู ุฌูุงุฒ ุขุฎุฑ
- โ ุงูุจูุงูุงุช ุชูุญุฐู ุนูุฏ ูุณุญ ุงููุงุด
- โ ูุง ูููู ูุดุงุฑูุฉ ุงูุจูุงูุงุช ุจูู ุงููุณุชุฎุฏููู

## โ ุงูุญู

ุชูุตูู ุงููุธุงู ุจูุงุนุฏุฉ ุจูุงูุงุช Supabase ุงูุญููููุฉ ุญูุซ:
- โ ุฌููุน ุงูุจูุงูุงุช ุชูุญูุธ ูู ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL
- โ ูููู ุชุณุฌูู ุงูุฏุฎูู ูู ุฃู ุฌูุงุฒ
- โ ุงูุจูุงูุงุช ุฏุงุฆูุฉ ููุญููุฉ
- โ ูุนูู ุงููุธุงู ุจุดูู ุญูููู 100%

---

## ๐ ุฎุทูุงุช ุงูุฅุตูุงุญ (15 ุฏูููุฉ)

### ุงูุฎุทูุฉ 1๏ธโฃ: ุฅูุดุงุก ุงูุฌุฏุงูู ูู Supabase

1. **ุงูุชุญ Supabase Dashboard**
   ```
   https://supabase.com/dashboard
   ```

2. **ุงุฐูุจ ูููุดุฑูุน ุงูุฎุงุต ุจู**
   - ุงุฎุชุฑ ุงููุดุฑูุน: `cndqifvqdospvetdmzom`

3. **ุงูุชุญ SQL Editor**
   ```
   Dashboard > SQL Editor > New Query
   ```

4. **ุงูุณุฎ ูุงูุตู ูุญุชูู ุงูููู**
   ```
   ๐-ุฅูุดุงุก-ุงูุฌุฏุงูู-ูู-Supabase.sql
   ```

5. **ุดุบูู ุงูููุฏ**
   ```
   ุงุถุบุท "Run" ุฃู Ctrl+Enter
   ```

6. **ุชุญูู ูู ุงููุฌุงุญ**
   ```
   ูุฌุจ ุฃู ุชุฑู: "ุชู ุฅูุดุงุก ุงูุฌุฏุงูู ุจูุฌุงุญ! โ"
   ```

### ุงูุฌุฏุงูู ุงูุชู ุชู ุฅูุดุงุคูุง:
- โ `users` - ูุนูููุงุช ุงููุณุชุฎุฏููู
- โ `students` - ุจูุงูุงุช ุงูุทูุงุจ
- โ `supervisors` - ุจูุงูุงุช ุงููุดุฑููู
- โ `courses` - ุงูููุฑุฑุงุช ุงูุฏุฑุงุณูุฉ
- โ `enrollments` - ุงูุชุณุฌููุงุช
- โ `registration_requests` - ุทูุจุงุช ุงูุชุณุฌูู
- โ `announcements` - ุงูุฅุนูุงูุงุช

---

### ุงูุฎุทูุฉ 2๏ธโฃ: ุงูุชุญูู ูู Edge Function

1. **ุงูุชุญ Edge Functions ูู Supabase**
   ```
   Dashboard > Edge Functions
   ```

2. **ุชุญูู ูู ูุฌูุฏ `make-server-1573e40a`**
   - ุฅุฐุง ูุงูุช ููุฌูุฏุฉ: โ ุฑุงุฆุน!
   - ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ: ูู ุจูุดุฑูุง

3. **ูุดุฑ Edge Function (ุฅุฐุง ูุฒู ุงูุฃูุฑ)**
   ```bash
   # ูู ูุฌูุฏ ุงููุดุฑูุน
   npx supabase functions deploy make-server-1573e40a
   ```

---

### ุงูุฎุทูุฉ 3๏ธโฃ: ุงูุชุญูู ูู Environment Variables

1. **ูู Vercel Dashboard**
   ```
   Settings > Environment Variables
   ```

2. **ุชุฃูุฏ ูู ูุฌูุฏ**:
   ```
   VITE_SUPABASE_URL=https://cndqifvqdospvetdmzom.supabase.co
   VITE_SUPABASE_ANON_KEY=eyJhbGc...
   ```

3. **ุฅุฐุง ูู ุชูู ููุฌูุฏุฉุ ุฃุถููุง ูู `vercel.json`**

---

### ุงูุฎุทูุฉ 4๏ธโฃ: Redeploy ุนูู Vercel

1. **Commit ุงูุชุบููุฑุงุช**
   ```bash
   git add .
   git commit -m "๐ง Fix: ุชูุตูู ุงููุธุงู ุจู Supabase"
   git push origin main
   ```

2. **Vercel ุณููุดุฑ ุงูุชุญุฏูุซ ุชููุงุฆูุงู**
   - ุงูุชุธุฑ 2-3 ุฏูุงุฆู

3. **ุฃู ุงุถุบุท Redeploy ูุฏููุงู**
   ```
   Vercel Dashboard > Deployments > [Latest] > Redeploy
   ```

---

### ุงูุฎุทูุฉ 5๏ธโฃ: ุงุฎุชุจุงุฑ ุงููุธุงู

#### 1. **ุงูุชุญ ุงููููุน ุงูููุดูุฑ**
```
https://your-project.vercel.app
```

#### 2. **ุงุฐูุจ ูุตูุญุฉ ุฅูุดุงุก ุญุณุงุจ**
```
/signup
```

#### 3. **ุฃูุดุฆ ุญุณุงุจ ุงุฎุชุจุงุฑู**
```
ุงูุงุณู: ุฃุญูุฏ ูุญูุฏ ุงูุบุงูุฏู
ุงูุฑูู ุงูุฌุงูุนู: 443123456
ุงูุจุฑูุฏ: ahmed.test@kku.edu.sa
ูููุฉ ุงููุฑูุฑ: Test@123
ุงูุชุฎุตุต: MIS
ุงููุณุชูู: 1
ุงููุนุฏู: 4.5
```

#### 4. **ุณุฌู ุงูุฏุฎูู**
```
ุงูุจุฑูุฏ: ahmed.test@kku.edu.sa
ูููุฉ ุงููุฑูุฑ: Test@123
```

#### 5. **ุชุญูู ูู ููุญุฉ ุงูุชุญูู**
- ูุฌุจ ุฃู ุชุตู ูููุญุฉ ุงูุทุงูุจ โ
- ูุฌุจ ุฃู ุชุฑู ุงุณูู ููุนูููุงุชู โ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### โ ุฎุทุฃ: "Table 'users' does not exist"

**ุงูุญู**:
```sql
-- ูู Supabase SQL Editor
-- ุดุบูู ุงูููู: ๐-ุฅูุดุงุก-ุงูุฌุฏุงูู-ูู-Supabase.sql
```

---

### โ ุฎุทุฃ: "Invalid credentials"

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ**:
1. **ุงูุจุฑูุฏ ุฃู ูููุฉ ุงููุฑูุฑ ุฎุทุฃ**
   - ุชุฃูุฏ ูู ูุชุงุจุฉ ุงูุจุฑูุฏ ูุงูุฑูู ุงูุณุฑู ุจุดูู ุตุญูุญ

2. **ุงูุญุณุงุจ ุบูุฑ ููุฌูุฏ**
   - ูู ุจุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ ุฃููุงู

3. **ูุดููุฉ ูู Supabase Auth**
   - ุชุญูู ูู Logs ูู Supabase Dashboard

**ุงูุญู**:
```
1. ุงุฐูุจ ูุตูุญุฉ ุฅูุดุงุก ุญุณุงุจ
2. ุฃูุดุฆ ุญุณุงุจ ุฌุฏูุฏ
3. ุฌุฑุจ ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู
```

---

### โ ุฎุทุฃ: "Failed to fetch"

**ุงูุฃุณุจุงุจ**:
1. **Edge Function ุบูุฑ ููุดูุฑุฉ**
2. **ูุดููุฉ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช**
3. **CORS issue**

**ุงูุญู**:
```bash
# 1. ุชุญูู ูู Edge Function
https://cndqifvqdospvetdmzom.supabase.co/functions/v1/make-server-1573e40a/health

# 2. ูุฌุจ ุฃู ุชุฑู:
{
  "status": "ok",
  "message": "KKU Course Registration System..."
}

# 3. ุฅุฐุง ูู ูุนููุ ุฃุนุฏ ูุดุฑ Edge Function:
npx supabase functions deploy make-server-1573e40a
```

---

### โ ุฎุทุฃ: "User with this email already exists"

**ุงูุญู**:
```
1. ุงููุณุชุฎุฏู ููุฌูุฏ ุจุงููุนู
2. ุงุณุชุฎุฏู "ุชุณุฌูู ุงูุฏุฎูู" ุจุฏูุงู ูู "ุฅูุดุงุก ุญุณุงุจ"
3. ุฃู ุงุณุชุฎุฏู ุจุฑูุฏ ุฅููุชุฑููู ูุฎุชูู
```

---

### โ ุงูุจูุงูุงุช ูุง ุชุธูุฑ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

**ุงูุญู**:
```sql
-- ูู Supabase SQL Editor
-- ุชุญูู ูู ุงูุจูุงูุงุช:

SELECT * FROM users WHERE email = 'ahmed.test@kku.edu.sa';
SELECT * FROM students WHERE user_id IN (SELECT id FROM users WHERE email = 'ahmed.test@kku.edu.sa');
```

---

## ๐งช ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

### 1. ุงุฎุชุจุงุฑ Health Check

```bash
# ุงูุชุญ ูู ุงููุชุตูุญ ุฃู Postman:
https://cndqifvqdospvetdmzom.supabase.co/functions/v1/make-server-1573e40a/health

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
{
  "status": "ok",
  "message": "KKU Course Registration System - SQL Database",
  "database": "PostgreSQL via Supabase"
}
```

### 2. ุงุฎุชุจุงุฑ Signup

```bash
curl -X POST \
  https://cndqifvqdospvetdmzom.supabase.co/functions/v1/make-server-1573e40a/auth/signup \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -d '{
    "email": "test@kku.edu.sa",
    "password": "Test@123",
    "name": "Test User",
    "studentId": "443123456",
    "role": "student",
    "major": "MIS",
    "level": "1",
    "gpa": "4.5"
  }'
```

### 3. ุงุฎุชุจุงุฑ Login

```bash
curl -X POST \
  https://cndqifvqdospvetdmzom.supabase.co/functions/v1/make-server-1573e40a/auth/login \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -d '{
    "email": "test@kku.edu.sa",
    "password": "Test@123"
  }'
```

---

## ๐ ุงูุชุญูู ูู ุงูุจูุงูุงุช ูู Supabase

### 1. ุนุฑุถ ุงููุณุชุฎุฏููู

```sql
-- ูู Supabase SQL Editor
SELECT 
  u.id,
  u.email,
  u.name,
  u.student_id,
  u.role,
  s.major,
  s.level,
  s.gpa
FROM users u
LEFT JOIN students s ON s.user_id = u.id
ORDER BY u.created_at DESC
LIMIT 10;
```

### 2. ุนุฏุฏ ุงููุณุชุฎุฏููู

```sql
SELECT 
  role,
  COUNT(*) as count
FROM users
GROUP BY role;
```

### 3. ุญุฐู ูุณุชุฎุฏู ุงุฎุชุจุงุฑู

```sql
-- ุงุญุฐู ุงููุณุชุฎุฏู ูู ุฌุฏูู users (ุณูุญุฐู ุชููุงุฆูุงู ูู students ุจุณุจุจ CASCADE)
DELETE FROM users WHERE email = 'test@kku.edu.sa';
```

---

## โ Checklist ุงูููุงุฆู

### ูุจู ุงูุงุฎุชุจุงุฑ:
- [ ] ุชู ุฅูุดุงุก ุงูุฌุฏุงูู ูู Supabase
- [ ] Edge Function ููุฌูุฏุฉ ููุดุทุฉ
- [ ] Environment Variables ุตุญูุญุฉ
- [ ] ุชู Redeploy ุนูู Vercel
- [ ] Health Check ูุนูู

### ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ:
- [ ] ูููู ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ
- [ ] ูููู ุชุณุฌูู ุงูุฏุฎูู
- [ ] ููุญุฉ ุงูุชุญูู ุชุธูุฑ
- [ ] ุงูุจูุงูุงุช ุชูุญูุธ ูู Supabase
- [ ] ูููู ุชุณุฌูู ุงูุฏุฎูู ูู ุฌูุงุฒ ุขุฎุฑ

### ุจุนุฏ ุงูุงุฎุชุจุงุฑ:
- [ ] ุงููุธุงู ูุนูู 100%
- [ ] ูุง ุชูุฌุฏ ุฃุฎุทุงุก
- [ ] ุฌููุน ุงูุตูุญุงุช ุชุนูู
- [ ] ุงูุจูุงูุงุช ูุญููุธุฉ

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ูุฐู ุงูุฎุทูุงุช:

### โ ูุง ูุฌุจ ุฃู ูุนูู:

1. **ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ**
   - ุงูุทุงูุจ ูููุฃ ุงููููุฐุฌ
   - ุงูุจูุงูุงุช ุชูุญูุธ ูู Supabase
   - ูุชู ุฅูุดุงุก ุณุฌู ูู ุฌุฏูู `users`
   - ูุชู ุฅูุดุงุก ุณุฌู ูู ุฌุฏูู `students`
   - ุงูุทุงูุจ ููุญููู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู

2. **ุชุณุฌูู ุงูุฏุฎูู**
   - ุงูุทุงูุจ ูุฏุฎู ุงูุจุฑูุฏ ููููุฉ ุงููุฑูุฑ
   - ุงููุธุงู ูุชุญูู ูู Supabase Auth
   - ุฅุฐุง ูุงูุช ุตุญูุญุฉุ ููุญููู ูููุญุฉ ุงูุชุญูู
   - ุฌูุณุฉ ุงููุณุชุฎุฏู ุชูุญูุธ

3. **ููุญุฉ ุงูุชุญูู**
   - ุชุธูุฑ ูุนูููุงุช ุงูุทุงูุจ ุงูุตุญูุญุฉ
   - ุงููุนุฏู ูุงููุณุชูู ูุงูุชุฎุตุต
   - ูููู ุชุตูุญ ุงูููุฑุฑุงุช
   - ูููู ุนุฑุถ ุงูุฌุฏูู

4. **ุงูุชุณุฌูู ูู ุฃุฌูุฒุฉ ูุฎุชููุฉ**
   - ููุณ ุงูุญุณุงุจ ูุนูู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
   - ุงูุจูุงูุงุช ูุชุฒุงููุฉ
   - ูุง ุญุงุฌุฉ ูุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:

### 1. ุชุญูู ูู Logs

**Supabase Logs**:
```
Dashboard > Logs > Edge Functions Logs
```

**Vercel Logs**:
```
Dashboard > Deployments > [Latest] > View Function Logs
```

### 2. ุชุญูู ูู Network

- ุงูุชุญ DevTools > Network
- ุงุจุญุซ ุนู ุงูุทูุจุงุช ุงููุงุดูุฉ (ุญูุฑุงุก)
- ุงูุธุฑ ููู Response

### 3. ุชุญูู ูู Console

- ุงูุชุญ DevTools > Console
- ุงุจุญุซ ุนู ุงูุฃุฎุทุงุก
- ุงูุฑุฃ ุงูุฑุณุงุฆู

---

## ๐ ุฎูุงุตุฉ

ุจุนุฏ ุชุทุจูู ูุฐู ุงูุฎุทูุงุชุ ุงููุธุงู ุณูุนูู ุจุดูู ุญูููู 100%:

```
โ ูุงุนุฏุฉ ุจูุงูุงุช ุญููููุฉ (PostgreSQL)
โ ูุตุงุฏูุฉ ุญููููุฉ (Supabase Auth)
โ ุจูุงูุงุช ุฏุงุฆูุฉ ููุญููุฉ
โ ูุนูู ูู ุฃู ุฌูุงุฒ
โ ุฌุงูุฒ ููุฅูุชุงุฌ
```

---

**ุขุฎุฑ ุชุญุฏูุซ**: 1 ุฏูุณูุจุฑ 2024  
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุชุทุจูู!  
**ุงูููุช ุงููุชููุน**: 15 ุฏูููุฉ โฐ

</div>

---

## ๐ English Quick Guide

### Quick Fix Steps:

1. **Create tables in Supabase**
   - Copy `๐-ุฅูุดุงุก-ุงูุฌุฏุงูู-ูู-Supabase.sql`
   - Paste in Supabase SQL Editor
   - Run

2. **Redeploy on Vercel**
   ```bash
   git push origin main
   ```

3. **Test signup and login**
   - Create a new account
   - Login
   - Check dashboard

4. **Done!** โ

---

**Made with โค๏ธ for King Khalid University**
